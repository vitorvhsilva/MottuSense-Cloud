IF OBJECT_ID('TB_USUARIO_FILIAL', 'U') IS NOT NULL DROP TABLE TB_USUARIO_FILIAL;
IF OBJECT_ID('TB_USUARIO', 'U') IS NOT NULL DROP TABLE TB_USUARIO;
IF OBJECT_ID('TB_FILIAL', 'U') IS NOT NULL DROP TABLE TB_FILIAL;
IF OBJECT_ID('LOCALIZACAO', 'U') IS NOT NULL DROP TABLE LOCALIZACAO;
IF OBJECT_ID('TB_CONFIGURACAO_USUARIO', 'U') IS NOT NULL DROP TABLE TB_CONFIGURACAO_USUARIO;

CREATE TABLE TB_CONFIGURACAO_USUARIO (
    ID_CONFIGURACAO_USUARIO NVARCHAR(36) PRIMARY KEY,
    ALERTA_MOTO_ENTRAR_PATIO BIT CHECK (ALERTA_MOTO_ENTRAR_PATIO IN (0,1)),
    ALERTA_MOTO_SAIR_PATIO BIT CHECK (ALERTA_MOTO_SAIR_PATIO IN (0,1)),
    ALERTA_MOTO_CHEGAR_SEM_PLACA BIT CHECK (ALERTA_MOTO_CHEGAR_SEM_PLACA IN (0,1)),
    ALERTA_MOTO_PRECISA_MANUTENCAO BIT CHECK (ALERTA_MOTO_PRECISA_MANUTENCAO IN (0,1)),
    ALERTA_MOTO_PREPARADA_ALUGADA BIT CHECK (ALERTA_MOTO_PREPARADA_ALUGADA IN (0,1))
);

CREATE TABLE LOCALIZACAO (
    ID_LOCALIZACAO NVARCHAR(36) PRIMARY KEY,
    CEP_LOCALIZACAO NVARCHAR(20),
    LOGRADOURO_LOCALIZACAO NVARCHAR(255),
    BAIRRO_LOCALIZACAO NVARCHAR(120),
    ESTADO_LOCALIZACAO NVARCHAR(50),
    REGIAO_LOCALIZACAO NVARCHAR(50)
);

CREATE TABLE TB_FILIAL (
    ID_FILIAL NVARCHAR(36) PRIMARY KEY,
    NOME_FILIAL NVARCHAR(120) NOT NULL,
    ID_LOCALIZACAO NVARCHAR(36) UNIQUE,
    CONSTRAINT FK_FILIAL_LOCALIZACAO FOREIGN KEY (ID_LOCALIZACAO)
        REFERENCES LOCALIZACAO(ID_LOCALIZACAO)
);

CREATE TABLE TB_USUARIO (
    ID_USUARIO NVARCHAR(36) PRIMARY KEY,
    NOME_USUARIO NVARCHAR(120),
    CPF_USUARIO NVARCHAR(14),
    TELEFONE_USUARIO NVARCHAR(30),
    EMAIL_USUARIO NVARCHAR(150),
    SENHA_USUARIO NVARCHAR(255),
    LINK_FOTO_USUARIO NVARCHAR(500),
    DATA_NASCIMENTO_USUARIO DATE,
    DATA_CRIACAO_USUARIO DATETIME2,
    ID_CONFIGURACAO_USUARIO NVARCHAR(36) UNIQUE,
    CONSTRAINT FK_USUARIO_CONFIG FOREIGN KEY (ID_CONFIGURACAO_USUARIO)
        REFERENCES TB_CONFIGURACAO_USUARIO(ID_CONFIGURACAO_USUARIO)
);

CREATE TABLE TB_USUARIO_FILIAL (
    ID_USUARIO NVARCHAR(36) NOT NULL,
    ID_FILIAL NVARCHAR(36) NOT NULL,
    CONSTRAINT PK_USUARIO_FILIAL PRIMARY KEY (ID_USUARIO, ID_FILIAL),
    CONSTRAINT FK_UF_USUARIO FOREIGN KEY (ID_USUARIO) REFERENCES TB_USUARIO(ID_USUARIO),
    CONSTRAINT FK_UF_FILIAL FOREIGN KEY (ID_FILIAL) REFERENCES TB_FILIAL(ID_FILIAL)
);

INSERT INTO LOCALIZACAO VALUES 
('f47c39f4-9e45-46ff-9e43-46e96d1c0180','01310000','Av. Paulista, 1000','Bela Vista','SP','Sudeste'),
('b5f3f8b7-98b1-4b3d-87a9-dcce4973fd6a','01000000','Rua Augusta, 2000','Cerqueira César','SP','Sudeste'),
('26cdb15a-99b4-4a0f-8ad0-ecb7727c3965','02510000','Rua do Acre, 500','Vila Nova Cachoeirinha','SP','Norte'),
('e5b36a50-b581-4234-bd6d-34a51be4d312','04510100','Rua dos Três Irmãos, 1200','Brooklin','SP','Sudeste'),
('aaffd132-8b12-4ff0-8e8a-9a24601a27c9','03050000','Rua da Mooca, 1500','Mooca','SP','Leste');

INSERT INTO TB_FILIAL VALUES
('6cfa5b26-ada4-4bfc-a372-f50a1b9df36f','Filial São Paulo','f47c39f4-9e45-46ff-9e43-46e96d1c0180'),
('62e58297-42bb-4d25-bc95-c99bfa4f71be','Filial Rio de Janeiro','b5f3f8b7-98b1-4b3d-87a9-dcce4973fd6a'),
('8d7a1582-7cf9-4972-a474-956c8d25cb68','Filial Belo Horizonte','26cdb15a-99b4-4a0f-8ad0-ecb7727c3965'),
('31370b19-8e5f-4303-9ff5-9e9f35b53ca7','Filial Porto Alegre','e5b36a50-b581-4234-bd6d-34a51be4d312'),
('b2c70958-62bb-4d33-96e7-5d442a8cc3e9','Filial Curitiba','aaffd132-8b12-4ff0-8e8a-9a24601a27c9');

INSERT INTO TB_CONFIGURACAO_USUARIO VALUES
('cf78e445-2a3a-4e8c-9602-27e5d36a3f26',1,1,1,0,0),
('b5103e28-7b50-45e3-b4bc-09b75ab8c1c2',0,1,1,1,0),
('5de45eb2-144f-475f-b16d-e16e7e394706',1,0,0,0,1),
('d5e67343-d278-4cc4-9a5c-bb1ccf3bcd98',1,1,1,1,1),
('2490a88f-7353-4cc5-bf5d-b2048f4ca41f',0,0,0,0,0);

INSERT INTO TB_USUARIO VALUES
('3b64e3bb-10c5-4c84-9d77-2e5bb40a91d5','João Silva','123.456.789-00','(11) 98888-7777','joao@mottusense.com','$2a$10$hashdemonstrativo',NULL,CAST('1985-05-12' AS DATE),SYSDATETIME(),'cf78e445-2a3a-4e8c-9602-27e5d36a3f26'),
('ee41756c-e82c-4e12-84b3-2c0d5a5f9bc7','Maria Oliveira','987.654.321-00','(21) 99999-8888','maria@mottusense.com','$2a$10$hashdemonstrativo',NULL,CAST('1992-07-23' AS DATE),SYSDATETIME(),'b5103e28-7b50-45e3-b4bc-09b75ab8c1c2'),
('7bbfba3e-f97f-42a0-9460-607ed7030766','Carlos Pereira','321.654.987-00','(31) 96666-5555','carlos@mottusense.com','$2a$10$hashdemonstrativo',NULL,CAST('1988-03-30' AS DATE),SYSDATETIME(),'5de45eb2-144f-475f-b16d-e16e7e394706'),
('8b18cfe0-f881-4e3d-97db-923d9d0d5c39','Ana Souza','456.789.123-00','(61) 97777-4444','ana@mottusense.com','$2a$10$hashdemonstrativo',NULL,CAST('1995-12-11' AS DATE),SYSDATETIME(),'d5e67343-d278-4cc4-9a5c-bb1ccf3bcd98'),
('db8d0e3c-7ec2-4b10-917b-0cc775a520d8','Pedro Almeida','789.123.456-00','(41) 98888-3333','pedro@mottusense.com','$2a$10$hashdemonstrativo',NULL,CAST('1987-11-02' AS DATE),SYSDATETIME(),'2490a88f-7353-4cc5-bf5d-b2048f4ca41f');
